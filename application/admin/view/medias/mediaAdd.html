{include file="common/head"/}
<div class="layui-fluid">
    <div class="layui-row layui-col-space15">
        <div class="layui-card">
            <div class="layui-btn-group">
                <fieldset class="layui-elem-field layui-field-title">
                    <legend>添加媒体</legend>
                </fieldset>
            </div>
            <div class="layui-btn-table">
                <!--首页点击人数/人次-->
                <form class="layui-form layui-form-pane">
                    <div class="layui-form-item">
                        <label class="layui-form-label" style="width: 200px">媒体名称</label>
                        <div class="layui-input-4" style="width: 600px;float: left;">
                            <input autocomplete="off" type="text" name="media_name" value="{notempty name='$info'}{$info.media_name}{/notempty}" lay-verify="required" placeholder="请输入媒体名称" class="layui-input">
                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label" style="width: 200px">媒体标识</label>
                        <div class="layui-input-4" style="width: 600px;float: left;">
                            <input autocomplete="off" type="text" name="media_ident" value="{notempty name='$info'}{$info.media_ident}{/notempty}" lay-verify="required" placeholder="请输入媒体标识" class="layui-input">
                        </div>
                        <span style="height: 38px;line-height: 38px;color: #ff0000;">媒体标识为媒体拼音的首字母组成</span>
                    </div>

                    <!--<div class="layui-form-item">
                        <label class="layui-form-label" style="width: 200px">分成比例</label>
                        <div class="layui-input-4">
                            <input autocomplete="off" type="text" name="media_divide" ng-model="field.media_divide" lay-verify="required|rate" placeholder="请输入媒体分成" class="layui-input">
                        </div>
                        <span style="height: 38px;line-height: 38px;color: #ff0000;">0-1之间的两位小数</span>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label" style="width: 200px">提现账号</label>
                        <div class="layui-input-block">
                            <input type="radio" name="media_account" ng-model="field.media_account" ng-checked="field.media_account==1" ng-value="1" title="个人账号">
                            <input type="radio" name="media_account" ng-model="field.media_account" ng-checked="field.media_account==2" ng-value="2" title="企业帐号">
                        </div>
                        <div class="layui-input-block">
                            <div class="layui-input-4">
                                <input autocomplete="off" type="text" name="media_account_num" ng-model="field.media_account_num" lay-verify="required" placeholder="请输入提现账号" class="layui-input">
                            </div>
                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label" style="width: 200px">账号名称</label>
                        <div class="layui-input-4">
                            <input autocomplete="off" type="text" name="media_bank_username" ng-model="field.media_bank_username" lay-verify="required" placeholder="请输入账号名称" class="layui-input">
                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label" style="width: 200px">开户行行别</label>
                        <div class="layui-input-4">
                            <input autocomplete="off" type="text" name="media_bank_name" ng-model="field.media_bank_name" lay-verify="required" placeholder="请输入开户行行别" class="layui-input">
                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label" style="width: 200px">账号所在省</label>
                        <div class="layui-input-4">
                            <input autocomplete="off" type="text" name="media_bank_province" ng-model="field.media_bank_province" lay-verify="required" placeholder="请输入账号所在省" class="layui-input">
                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label" style="width: 200px">账号所在市</label>
                        <div class="layui-input-4">
                            <input autocomplete="off" type="text" name="media_bank_city" ng-model="field.media_bank_city" lay-verify="required" placeholder="请输入账号所在市" class="layui-input">
                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label" style="width: 200px">账号所属支行</label>
                        <div class="layui-input-4">
                            <input autocomplete="off" type="text" name="media_bank_branch" ng-model="field.media_bank_branch" lay-verify="required" placeholder="请输入账号所属支行" class="layui-input">
                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label" style="width: 200px">媒体联系方式</label>
                        <div class="layui-input-4">
                            <input autocomplete="off" type="text" name="media_contact_phone" ng-model="field.media_contact_phone"  placeholder="请输入联系方式" class="layui-input">
                        </div>
                    </div>-->

                    <div class="layui-form-item">
                        <label class="layui-form-label" style="width: 200px">关联商务</label>
                        <div class="layui-input-4" style="width: 600px;float: left;">
                            <input autocomplete="off" type="text" name="media_butt" value="{notempty name='$info'}{$info.media_butt}{/notempty}" lay-verify="required" placeholder="请输入关联商务" class="layui-input">
                        </div>
                    </div>

                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <button type="button" class="layui-btn" lay-submit="" lay-filter="submit">提交</button>
                            <a href="{:url('index')}" class="layui-btn layui-btn-primary">返回</a>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{include file="common/foot"/}
<script>
    layui.use(['form', 'layer','upload'], function () {
        var form = layui.form, $ = layui.jquery, upload = layui.upload;
        var media_id = {$media_id};
        form.on('submit(submit)', function (data) {
            // 提交到方法 默认为本身
            var action = '';
            if(media_id>0){
                //编辑
                action = "{:url('editMedia')}";
                data.field.media_id = media_id;
            }else{
                //添加
                action = "{:url('addMedia')}";
            }
            var loading = layer.load(1, {shade: [0.1, '#fff']});
            $.post(action, data.field, function (res) {
                layer.close(loading);
                if (res.code > 0) {
                    layer.msg(res.msg, {time: 1800, icon: 1}, function () {
                        location.href = res.url;
                    });
                } else {
                    layer.msg(res.msg, {time: 1800, icon: 2});
                }
            });
        });

        form.verify({
            rate:function(value,item){
                if(!new RegExp("0\.?[0-9]+$").test(value)){
                    return "请输入正确费率！";
                }
            }
        });

    });
</script>